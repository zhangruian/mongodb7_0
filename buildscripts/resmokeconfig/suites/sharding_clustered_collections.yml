test_kind: js_test

selector:
  roots:
  - jstests/sharding/*.js
  - jstests/sharding/change_streams/*.js
  - jstests/sharding/query/*.js
  - jstests/sharding/load_balancer_support/*.js
  - jstests/sharding/health_monitor/*.js
  exclude_files:
  # TODO (SERVER-60824): Support non-blocking sort() for resharding cloner.
  - jstests/sharding/test_resharding_test_fixture_shutdown_retry_needed.js
  - jstests/sharding/resharding_collection_cloner_resuming.js
  # TODO (SERVER-60824): Support non-blocking sort() to prevent 'Sort exceeded memory limit'.
  - jstests/sharding/shard6.js
  # Expects hint(_id) to yield an index scan instead of a table scan.
  - jstests/sharding/shard2.js
  # TODO (SERVER-62874): Investigate the following test failures.
  - jstests/sharding/internal_sessions_partial_index.js
  - jstests/sharding/change_stream_show_migration_events.js
  - jstests/sharding/move_primary_with_writes.js
  exclude_with_any_tags:
  - expects_explicit_underscore_id_index

executor:
  config:
    shell_options:
      nodb: ''
      global_vars:
        TestData:
          setParameters:
            featureFlagClusteredIndexes: true
            enableTestCommands: 1
            internalQueryForceClassicEngine: 1
            failpoint.clusterAllCollectionsByDefault: "{mode: 'alwaysOn'}"
